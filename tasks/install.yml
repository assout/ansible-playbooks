---

- hosts: localhost
  connection: local
  sudo: yes
  vars:
    fedora_version: 21
  tasks:
    - name: upgrade all packages
      yum: name=* state=latest disablerepo=fedora-chromium-stable,google-chrome

    - yum: name={{ item }} state=latest
      with_items:
        - apvlv # pdf viewer
        - byobu # tmux/GNU screen wrapper
        - cadaver # WevDAV client
        - cmigemo
        - ctags
        - dconf-editor
        - devscripts-minimal # for checkbahisms
        - eclipse
        - ftp
        - gcc
        - gftp # ftp client
        - gnome-tweak-tool
        - go
        - graphviz # for plantuml
        - gvim
        - hg # for ttyrec2gif
        - ibus-mozc # required logout/login
        - key-mon # screen key input
        - man-pages-ja
        - maven
        - nkf
        - npm
        - pandoc
        - plantuml
        - python-pip
        - shcov
        - shunit2
        - strace
        - vim
        - w3m # for vim-plugin vim-ref
        - wine
        - xclip
        - xvkbd # for vim-plugin im_control.
        - xwd # for ttygif

    - debug: msg="install dropbox"
    - copy: src=files/dropbox.repo dest=/etc/yum.repos.d/ follow=yes
    - yum: name=nautilus-dropbox state=latest enablerepo=Dropbox
    - command: dropbox

    - debug: msg="install insync"
    - copy: src=files/insync.repo dest=/etc/yum.repos.d/ follow=yes
    - rpm_key: state=present key=https://d2t3ff60b2tol4.cloudfront.net/repomd.xml.key
    - yum: name=insync state=latest enablerepo=insync

    - debug: msg="install calibre"
    - copy: src=files/fedora-calibre.repo dest=/etc/yum.repos.d/ follow=yes
    - yum: name=calibre state=latest enablerepo=fedora-calibre

    - debug: msg="install chormium"
    - command: which chromium-browser
      register: has_chromium
      ignore_errors: yes
    - get_url: url=http://repos.fedorapeople.org/repos/spot/chromium-stable/fedora-chromium-stable.repo dest=/etc/yum.repos.d/
      when: has_chromium.rc != 0
    - replace: dest=/etc/yum.repos.d/fedora-chromium-stable.repo regexp='enable=1' replace='enable=0'
    - get_url: url=http://repos.fedorapeople.org/repos/spot/chromium-stable/spot.gpg dest=/etc/pki/rpm-gpg/spot.gpg
      when: has_chromium.rc != 0
    - yum: name=chromium state=latest enablerepo=fedora-chromium-stable

    - debug: msg="install screenkey" # screen key input
    - command: which screenkey
      register: has_screenkey
      ignore_errors: yes
    - get_url: url=http://download.opensuse.org/repositories/home:Kenzy:packages/Fedora_{{ fedora_version }}/home:Kenzy:packages.repo dest=/etc/yum.repos.d/
      when: has_screenkey.rc != 0
    - replace: dest=/etc/yum.repos.d/home:Kenzy:packages.repo regexp='enable=1' replace='enable=0'
    - yum: name=screenkey state=latest enablerepo=home_Kenzy_packages

    - debug: msg="install playonlinux"
    - command: which playonlinux
      register: has_playonlinux
      ignore_errors: yes
      sudo: no
    - get_url: url=http://rpm.playonlinux.com/playonlinux.repo dest=/etc/yum.repos.d/
      when: has_playonlinux.rc != 0
    - replace: dest=/etc/yum.repos.d/playonlinux.repo regexp='enable=1' replace='enable=0'
    - yum: name=playonlinux state=latest enablerepo=playonlinux

    - pip: name=vim-vint
    - pip: name=ansible-lint

    - npm: name=wunderline global=yes
    - npm: name=ttystudio global=yes

