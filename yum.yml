---

- hosts: localhost
  connection: local
  tasks:
    - name: upgrade all packages
      yum: name=* state=latest disablerepo=fedora-chromium-stable
      sudo: yes

    - yum: name={{ item }} state=latest
      sudo: yes
      with_items:
        - yum-plugin-fastestmirror
        - vim
        - gvim
        - gcc
        - wine 
        - eclipse
        - gnome-tweak-tool
        - xclip
        - dconf-editor
        - python-pip
        # required logout/login
        - ibus-mozc

    - command: which vint
      register: has_vint
      ignore_errors: yes

    - command: pip install vim-vint
      when : has_vint.rc == 1
      sudo: yes

    - name: get chromium repo
      get_url: url=http://repos.fedorapeople.org/repos/spot/chromium-stable/fedora-chromium-stable.repo dest=/etc/yum.repos.d/
      sudo: yes

    - name: get chromium repo pgp
      get_url: url=http://repos.fedorapeople.org/repos/spot/chromium-stable/spot.gpg dest=/etc/pki/rpm-gpg/spot.gpg
      sudo: yes

    - yum: name=chromium state=latest
      sudo: yes

    - copy: src=dropbox.repo dest=/etc/yum.repos.d/ follow=yes
      sudo: yes

    # required manual setup
    - yum: name=nautilus-dropbox state=latest enablerepo=Dropbox
      sudo: yes

    - command: dropbox

    - stat: path="/home/oji/.wine/drive_c/Program Files (x86)/Amazon/Kindle/Kindle.exe"
      register: has_kindle

    - name: get kindle for pc for wine
      get_url: url=http://www.amazon.co.jp/kindlepcdownload dest=/tmp
      when: has_kindle.stat.md5 is not defined

    - command: wine KindleForPC-installer.exe
      when: has_kindle.stat.md5 is not defined

